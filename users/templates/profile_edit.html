{% extends "base.html" %}
{% load staticfiles %}
{% load widget_tweaks %}
{% block title %}HackLaunch - Edit profile{% endblock %}

{% block content %}

    <div class="container">
        <h1 class="">Edit Profile</h1>

        <hr class="">
        <div class="row">
            <form class="form-horizontal" role="form" method="post" enctype="multipart/form-data"
                  onsubmit="return profileValidation.validate()">
                {% csrf_token %}
                <!-- left column -->
                <div class="col-md-3 equal small">
                    <div class="text-center">
                        {% if form.initial.image %}
                            <img src="{{ form.initial.image.url }}" class="avatar" alt="avatar"/>
                        {% else %}
                            <img src="//placehold.it/100" class="avatar img-circle" alt="avatar">
                        {% endif %}

                        <h6 class="">Upload a different image</h6>

                        <span class="btn btn-default btn-file">
                            Browse {% render_field form.image %}
                        </span>

                        {% if form.errors.image %}
                            {% for error in form.errors.image %}
                                <p class="text-muted">
                                    <span style="color: red">{{ error }}</span>
                                </p>
                            {% endfor %}
                        {% endif %}
                    </div>
                    <div class="delete">
                        <a href="#" onclick="return confirm_delete(this);">Delete account</a>
                    </div>
                </div>

                <!-- edit form column -->
                <div class="col-md-9 personal-info equal">

                    <h3 class="">Personal</h3>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">First name:</label>

                        {% if form.errors.first_name %}
                            <div id="first-name-input" class="col-lg-6 has-error has-feedback">
                                {% render_field form.first_name name="first-name" class="form-control" id="first-name" onkeyup="profileValidation.removeErrorOnValue(this.value, this.name)" %}
                                <span id="first-name-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="first-name-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.first_name %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div id="first-name-input" class="col-lg-6">
                                {% render_field form.first_name class="form-control" %}
                                <span id="first-name-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="first-name-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}

                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Last name:</label>

                        {% if form.errors.last_name %}
                            <div id="last-name-input" class="col-lg-6 has-error has-feedback">
                                {% render_field form.last_name name="last-name" class="form-control" id="last-name" onkeyup="profileValidation.removeErrorOnValue(this.value, this.name)" %}
                                <span id="last-name-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="last-name-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.last_name %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6">
                                {% render_field form.last_name class="form-control" %}
                                <span id="last-name-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="last-name-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}

                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Email:</label>

                        <div class="col-lg-7" style="padding-top: 7px">
                            {% render_field user.email %}
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Username:</label>

                        {% if form.errors.username %}
                            <div id="username-input" class="col-lg-6 has-error has-feedback">
                                {% render_field form.username name='username' class="form-control" id="username" onkeyup="profileValidation.removeErrorOnValue(this.value, this.name)" %}
                                <span id="username-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="username-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.username %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6">
                                {% render_field form.username class="form-control" %}
                                <span id="username-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="username-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Location:</label>

                        {% if form.errors.location %}
                            <div id="location-input" class="col-lg-6 has-error has-feedback">
                                {% render_field form.location name='location' class="form-control" id="location" onkeyup="profileValidation.removeErrorOnValue(this.value, this.name)" %}
                                <span id="location-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="location-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.location %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6">
                                {% render_field form.location class="form-control" %}
                                <span id="location-icon"
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="location-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}
                    </div>

                    <hr class="content-divider">
                    <h3 class="">Experience</h3>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Skills:</label>

                        {% if form.errors.skills %}
                            <div id='skills-input' class="col-lg-6 has-error has-feedback">
                                {% render_field form.skills name='skills' class="form-control" id="skills" onkeyup="profileValidation.removeErrorOnValue(this.value, this.name)" %}
                                <span id='skills-icon' class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="skills-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.skills %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6">
                                {% render_field form.skills class="form-control" %}
                                <span id='skills-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="skills-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}
                    </div>

                    <div class="form-group">
                        <label class="col-lg-3 control-label">Maker type:</label>

                        {% if form.errors.maker_type %}
                            <div id='maker-type-input'
                                 class="col-lg-6 checkbox-horizontal has-error has-feedback checkbox checkbox-success checkbox-inline">
                                {% render_field form.maker_type name='maker_type' class="form-control checkbox-inline" id="maker-type" onkeyup="profileValidation.removeErrorOnValue(this.value, this.name)" %}
                                <span id='maker-type-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="maker-type-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.maker_type %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6 checkbox-horizontal">
                                {% render_field form.maker_type %}

                                <span id='maker-type-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="maker-type-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}
                    </div>


                    <div class="form-group">
                        <label class="col-lg-3 control-label">Summary:</label>

                        {% if form.errors.summary %}
                            <div id='summary-input' class="col-lg-6 has-error has-feedback">
                                {% render_field form.summary name='summary' class="form-control" id="summary" style="height: 150px;" onkeyup="profileValidation.removeErrorOnValue(this.value, this.name)" %}
                                <span id='summary-icon' class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="summary-errors" class="col-lg-3" style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.summary %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6">
                                {% render_field form.summary class="form-control" style="height: 150px;" %}
                                <span id='summary-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="summary-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}
                    </div>

                    <hr class="content-divider">
                    <h3 class="">Account</h3>

                    <div class="form-group">
                        <label class="col-md-3 control-label">Password:</label>

                        {% if form.errors.password %}
                            <div id='password-input' class="col-lg-6 has-error has-feedback">
                                {% render_field form.password name='password' value=form.password.value id="password_confirmation" type="password" class="form-control" onkeyup="profileLoginMessage.passwordStrength(this.value)" %}
                                <span id='password-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="password-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.password %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6">
                                {% render_field form.password placeholder="**********" id="password_confirmation" type="password" class="form-control" onkeyup="profileLoginMessage.passwordStrength(this.value)" %}
                                <span id='password-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="password-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label">Confirm password:</label>

                        {% if form.errors.password_confirmation %}
                            <div id='password-confirmation' class="col-lg-6 has-error has-feedback">
                                {% render_field form.password_confirmation name='password-confirmation' value=form.password_confirmation.value type="password" class="form-control" onkeyup="profileLoginMessage.passwordStrength(this.value)" %}
                                <span id='password-confirmation-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="password_confirmation-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">
                                {% for error in form.errors.password_confirmation %}
                                    <p class="text-muted">
                                        <span style="color: red">{{ error }}</span>
                                    </p>
                                {% endfor %}
                            </div>
                        {% elif form.non_field_errors %}
                            <div class="col-lg-6 has-error has-feedback">
                                {% render_field form.password_confirmation value=form.password_confirmation.value type="password" class="form-control" onkeyup="profileLoginMessage.passwordStrength(this.value)" %}
                                <span class="glyphicon glyphicon-remove form-control-feedback"></span>
                            </div>
                            <div id="password_confirmation-errors" class="col-lg-3"
                                 style="padding-top: 7px; padding-left: 5px;">

                                {% for error in form.non_field_errors %}
                                    {% if error ==  'Passwords do not match' %}
                                        <p class="text-muted">
                                            <span style="color: red">{{ error }}</span>
                                        </p>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="col-lg-6">
                                {% render_field form.password_confirmation placeholder="**********" type="password" class="form-control" onkeyup="profileLoginMessage.matchPasswords(this.value)" %}
                                <span id='password-confirmation-icon'
                                      class="glyphicon glyphicon-remove form-control-feedback hidden"></span>
                            </div>
                            <div id="password-confirmation-errors" class="col-lg-3 hidden"
                                 style="padding-top: 7px; padding-left: 5px;"></div>
                        {% endif %}
                    </div>
                    <div>
                        <div id="profile-login-message" class="row">

                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-3 control-label"></label>

                        <div class="col-md-7">
                            <input class="btn btn-primary" value="Save Changes" type="submit">

                            <input class="btn btn-default" value="Cancel" type="reset">
                        </div>
                    </div>
            </form>
        </div>
    </div>

{% endblock %}

{% block extra_scripts %}
    <script type="text/javascript">
        {# todo review reactive #}
        var small = $(".equal").height();

        var equalHeight = function () {
            if ($(document).width() >= 992) {
                var heights = $(".equal").map(function () {
                            return $(this).height();
                        }).get(),

                        maxHeight = Math.max.apply(null, heights);

                $(".equal").height(maxHeight);
            } else {
                $(".small").height(small);
            }
        };

        var positionDelete = function() {
            var del = $(".delete");
            del.removeAttr('style');

            if ($(document).width() >= 992) {
                $(".delete").css({'position': 'absolute', 'bottom': '65px', 'left': '80px'});
            } else {
                $(".delete").css({'text-align': 'right'});
            }
        }

        $(document).ready(function () {
            equalHeight();
            positionDelete();
        });

        window.onresize = function (event) {
            equalHeight();
            positionDelete();
        };

        function confirm_delete(node) {
             if (confirm("Warning your account is about to be deleted. Do you wish to continue?")) {
                 window.location = '/delete_user';
             }
        }

    </script>

{% endblock %}
